<%-include('head')%>
<%if(locals.auth){%>
   
    <%-include('nav')%>
    <%}else if(locals.auth===false){%>
       
        <%-include('nav2')%>
        <%}%>
        <header id="login-container">
            <div class="container pt-3" >
               <div class="row justify-content-center">
                  
              <div class="col-lg-6">
               <div class="card shadow-lg border-0 rounded-lg mt-5 mb-5">
               <div class="card-header justify-content-center"><h3 class="font-weight-light my-4">Create an Account</h3></div>
                <div class="card-body">

       <form action="/auth/Signup" method="POST">
        <div class="form-group">
            <div class="col-md-12">    
        <label for="username">UserName</label><br>
        <input type="text" name="username" id="username" class="form-control">
        </div>
        </div>
        <div name="usernameerror" calss="usernameerror" id="usernameerror"></div><br>
        <div class="form-group">
            <div class="col-md-12">    
        <label for="email">Email</label><br>
        <input type="email" name="email" id="email" class="form-control">
        </div>
        </div>
        <div name="emailerror" calss="email error" id="emailerror"></div>
        <br>
        <div class="form-group">
            <div class="col-md-12">    
        <label for="password">Password</label><br>
        <input type="password" name="password" id="" class="form-control">
        </div>
        </div>
        <div name="passworderror" class="password error" id="passworderror"></div>

        <br><br>
        <input type="submit" name="submit"  class="btn btn-warning btn-block"
           >
           <!-- style="background-color: rgb(194, 179, 179);width: 20%;height: 8%;font-size: 150%;" -->
    </form>
</div>

</div>
</div>
</div>
</div>
</header>

    <script>
        const form = document.querySelector('form')
        const emailerror = document.getElementById('emailerror')
        const passworderror = document.getElementById('passworderror')
        const usernameerror= document.getElementById('usernameerror')
        form.addEventListener('submit', async (e) => {
            e.preventDefault();
            usernameerror.textContent=''
            emailerror.textContent = ''
            passworderror.textContent = ''
            username=form.username.value
            email = form.email.value;
            password = form.password.value;
            try {
                const res = await fetch('/auth/Signup',{
                    
                    body: JSON.stringify({ username,email, password }),
                    headers: { 'Content-Type': 'application/json' },
                    method: "POST",})

                const data = await res.json();

               console.log(data.error)
                //console.log("Asasa")
                if (data.error) {
                    // usernameerror.textContent=data.error.username
                    // emailerror.textContent = data.error.email
                    // passworderror.textContent = data.error.password
                    if(data.error.username){
                        usernameerror.textContent = data.error.username
                document.getElementById('username').focus()}
                if(data.error.email){
                emailerror.textContent = data.error.email
                document.getElementById('email').focus()}
                
                if(data.error.password){
                    passworderror.textContent = data.error.password
             document.getElementById('password').focus()
                        }
              
                }
                if (data.user) {
                    location.assign('/  ')
                }

            }
            catch (err) {
                console.log(err)
            }

        })
</script>
    <%-include('footer')%>